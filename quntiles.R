#R code for the paper Junike, G. (2025). Precise quantile function estimation from the characteristic function. Statistics & Probability Letters, 222, 110395.

library(Deriv)

eps_global=0.005
#eps_global=0.0005

#Given p and function f and tolerance eps, 
#find y such that |y - f^-(p)| < eps by bisection method.
#Using uniroot instead makes the code much faster
bisection=function(f,p,a,b,eps){
  tmp=function(y){f(y)-p}
  mid=(b+a)/2
  while((b-a)>eps){
    mid=(b+a)/2
    ifelse(sign(tmp(mid)) == sign(tmp(a)),a <- mid,b <- mid)  
  }
  mid
}

#Get interval (a,b) and number of terms N for the COS method
abN=function(eps,lower_bound=-Inf,upper_bound=Inf){
  n=8
  ell=(2*abs(1/1i^n*phi8(0))/eps)^(1/n)
  a=max(mu-ell,lower_bound)
  b=min(mu+ell,upper_bound)
  L=(b-a)/2
  s=39
  integrand = function(u){1 /  pi * abs(u)^(s + 1) * abs(phi(u))}
  boundDeriv = integrate(integrand, 0, Inf)$value
  tmp = 2^(s + 5 / 2) * boundDeriv * L^(s + 2) * 12
  N = ceiling((tmp / (s * pi^(s + 1) * eps))^(1 / s))
  if(is.finite(lower_bound))
    N=50 #Since the density of TS distribution is not smooth, we set N=50
  c(a,b,N)
}
#COS coefficients of the density.
ck = function(a,b, N){
  2 / (b-a) * Re(phi(0:N * pi / (b-a)) *  exp(-1i * 0:N * pi*a/(b-a)))
}
#COS approximation of the density
h=function(x,a,b,N){
  tmp=ck(a,b,N)*cos(0:N*pi*(x-a)/(b-a))
  tmp[1]=tmp[1]/2
  sum(tmp)
}
#approximation of CDF by COS method
H = function(y,a,b,N){
  res=0
  if(y<a){
    res=0
  }else{
    psi0=(b-a)/(0:N*pi)*sin(0:N*pi*(min(y,b)-a)/(b-a))
    psi0[1]=(min(y,b)-a)
    res=ck(a,b, N)*psi0
    res[1]=res[1]/2
  }
  sum(res)
}

#Approximation of the quantile function by the COS method: inverting H.
HInv=function(p,a,b,N,eps){
  tmp=function(y){H(y,a,b,N)}
  bisection(tmp,p,a,b,eps)
}

#Alternative method to inverst H using uniroot, which is much fast than bisection
#Inverse of H
#HInv=function(p,a,b,N){
#  myf=function(y){H(y,a,b,N)-p}
#  uniroot(myf,c(a,b),tol = .Machine$double.eps^0.25/1000, maxiter = 1000000)$root 
#}

#approximation of CDF by Gil-Paleaz Formula
HGP=function(y,positive_real_line=F){
  if(!positive_real_line){
    tmp=function(u){Re(phi(u)/(1i*2*pi*u)*exp(-1i*u*y))}
    0.5-integrate(tmp,-Inf,Inf,subdivisions = 100000000,rel.tol = 0.00000000001)$value
  }else{
    tmp=function(u){2/pi*Re(phi(u))*sin(y*u)/u}
    integrate(tmp,0,Inf,subdivisions = 100000000,rel.tol = 0.00000000001)$value
  }
}

######################
#### Normal ##########
######################
mu=0
phi= function(u){exp(- u^2 / 2)}
phi1=Deriv(phi,"u")
phi2=Deriv(phi1,"u")
phi3=Deriv(phi2,"u")
phi4=Deriv(phi3,"u")
phi5=Deriv(phi4,"u")
phi6=Deriv(phi5,"u")
phi7=Deriv(phi6,"u")
phi8=Deriv(phi7,"u")
ps=c(75,90,99)/100

resNormal=matrix(numeric(length(ps)*11),ncol=11)
for(i in 1:length(ps)){
  p=ps[i]
  Finv_p=HInv(p,abN(10^-9)[1],abN(10^-9)[2],10^7,10^-9) #F^-1(p)
  Finv_p=qnorm(p)
  myabN=abN(eps_global)
  a=myabN[1]
  b=myabN[2]
  N=myabN[3]
  y=HInv(p,a,b,N,eps_global) #H^-1(p)
  H_y=H(y,a,b,N) #H(y)
  F_y=H(y,abN(10^-9)[1],abN(10^-9)[2],10^7) #F(y)

  F_y=pnorm(y)
  resNormal[i,1]=eps_global
  resNormal[i,2]=b-a
  resNormal[i,3]=N
  resNormal[i,4]=p
  resNormal[i,5]=y
  resNormal[i,6]=abs(H_y-F_y)
  resNormal[i,7]=abs(y-Finv_p)
  resNormal[i,8]=min(h(y-eps_global,a,b,N),h(y+eps_global,a,b,N))
  resNormal[i,9]=2*eps_global/resNormal[i,8]+eps_global
  resNormal[i,10]=H(y,abN(10^-9)[1],abN(10^-9)[2],10^7)
  resNormal[i,11]=HGP(y,F)
  
}
resNormal=as.data.frame(resNormal)
names(resNormal)=c("eps","b-a","N","p", "y","abs(H_y-F_y)",
                   "abs(y-Finv_p)","h(y)","RHS","F_y_COS_ref","F_y_GP_ref")
resNormal$DIS="Normal"


######################
###### NIG ###########
#####################
mu=0
alpha=1
beta=0
delta=1
phi=function(u){exp(-delta*(sqrt(alpha^2-(beta+1i*u)^2) -sqrt(alpha^2-beta^2)))}
phi1=Deriv(phi,"u")
phi2=Deriv(phi1,"u")
phi3=Deriv(phi2,"u")
phi4=Deriv(phi3,"u")
#phi5=Deriv(phi4,"u")
#phi6=Deriv(phi5,"u")
#phi7=Deriv(phi6,"u")
#phi8=Deriv(phi7,"u")
phi8=function (u){
  .e1 <- ((0+1i) * u + beta)^2
  .e2 <- alpha^2
  .e3 <- .e2 - .e1
  .e4 <- sqrt(.e3)
  .e5 <- 2/.e4
  .e6 <- .e5 + delta
  .e7 <- 1/.e4
  .e8 <- .e7 + delta
  .e9 <- 2 * .e6
  .e10 <- .e9 + .e5
  .e11 <- .e1/.e3
  .e13 <- .e1 * .e8/.e4
  .e14 <- .e13 + 3
  .e16 <- .e1 * .e6/.e3
  .e17 <- 2 * .e8
  .e18 <- 2 * .e11
  .e19 <- 4/.e4
  .e20 <- 2 * .e10
  .e21 <- .e14/.e3
  .e22 <- 6/.e4
  .e23 <- .e16 + .e17
  .e24 <- delta/.e4
  .e26 <- .e1 * .e10/.e3
  .e27 <- 2 + .e18
  .e28 <- .e9 + .e19
  .e29 <- .e20 + .e22
  .e30 <- .e28 + delta
  .e31 <- .e26 + .e9
  .e32 <- .e14 * .e8
  .e33 <- .e23/.e4
  .e34 <- .e32 + .e16
  .e36 <- .e1 * .e30/.e3
  .e37 <- 6 * .e11
  .e38 <- 3/.e4
  .e39 <- 2 * .e29
  .e40 <- .e38 + delta
  .e43 <- .e36 + .e17 + .e9 + .e5
  .e45 <- .e1 * .e29/.e3
  .e47 <- 2/.e3 + .e24
  .e49 <- 4/.e3 + .e24
  .e50 <- .e18 + 4
  .e51 <- .e23 * .e8
  .e52 <- 3 * .e21
  .e53 <- .e10 * .e27
  .e54 <- .e14/.e4
  .e55 <- 4 + .e37
  .e56 <- 2 * .e31
  .e57 <- 2 * .e21
  .e58 <- .e31 + .e5
  .e59 <- 18/.e4
  .e60 <- .e53 + .e55/.e4
  .e61 <- .e3 * .e4
  .e62 <- .e59 + .e39
  .e63 <- .e1/.e61
  .e64 <- 2 * .e33
  .e65 <- 2 * .e30
  .e67 <- (.e11 + 2) * .e8 + .e63
  .e68 <- .e21 + .e51
  .e69 <- .e68/.e4
  .e70 <- .e43 * .e8
  .e73 <- .e45 + .e56 + .e20 + .e19
  .e74 <- 8/.e4
  .e75 <- .e34 * .e49
  .e76 <- .e58 + delta
  .e78 <- .e1 * .e62/.e3
  .e79 <- 16/.e4
  .e80 <- .e27 * .e40
  .e82 <- .e54 + .e26 + .e9
  .e84 <- 8/.e3 + .e24
  .e85 <- 2 * delta
  .e86 <- (.e70 + .e64 + .e52)/.e4
  .e87 <- .e78 + .e79
  .e89 <- .e34 * .e47 + .e69
  .e90 <- .e33 + .e57
  .e91 <- 2 * .e82
  .e92 <- .e67/.e4
  .e93 <- 4 * .e6
  .e94 <- .e31/.e3
  .e95 <- .e34 * .e84
  .e96 <- 3 * .e90
  .e97 <- 2 * .e73
  .e98 <- 2 * .e60
  .e100 <- .e1 * .e28/.e3
  .e101 <- .e50 * .e6
  .e102 <- .e87 + .e97
  .e103 <- .e75 + .e86
  .e104 <- 8 * .e11
  .e105 <- .e45 + .e20
  .e106 <- .e16 + .e80
  .e107 <- .e16 + .e8 * .e50
  .e109 <- .e54 + .e100 + .e101
  .e110 <- .e65 + .e74
  .e111 <- .e89 + .e76/.e3
  .e112 <- .e105 + .e19
  .e113 <- .e18 + 6
  .e114 <- .e9 + .e85
  .e115 <- .e103 + .e73/.e3
  .e116 <- .e43/.e4
  .e117 <- .e106 + .e17
  .e118 <- .e114 + .e22
  .e119 <- 4 * .e8
  .e120 <- .e92 + .e57
  .e122 <- .e102 + .e98 + .e39
  .e123 <- 6 * .e27
  .e124 <- 2 * .e51
  .e125 <- 2 * .e76
  .e127 <- .e1 * .e110/.e3
  .e128 <- .e60 + .e91
  .e129 <- .e58 * .e8
  .e130 <- .e19 + delta
  .e131 <- 8 + .e104
  .e132 <- (.e21 + .e124)/.e4
  .e133 <- .e43 * .e130
  .e135 <- .e127 + .e65 + .e74
  .e136 <- 2 * .e115
  .e137 <- .e107 * .e40
  .e139 <- (.e11 + 4) * .e8 + .e1 * .e40/.e3
  .e140 <- .e113 * .e6
  .e141 <- 2 * .e40
  .e142 <- 6 * .e21
  .e143 <- .e122/.e3
  .e144 <- 2 * .e112
  .e145 <- .e132 + .e109/.e3
  .e146 <- .e135 * .e8
  .e147 <- .e29 * .e27
  .e148 <- 2 * .e62
  .e150 <- .e116 + (.e30 * .e27 + .e131/.e4) * .e8 + .e96
  .e152 <- .e1 * .e118/.e3
  .e153 <- .e67 * .e8
  .e154 <- .e147 + (.e55 + .e123)/.e4
  .e156 <- .e111 * .e1 + .e32
  .e157 <- .e153 + .e21
  .e158 <- 10 + .e37
  .e159 <- 12/.e4
  .e160 <- 2 * .e28
  .e162 <- .e146 + .e133 + .e64
  .e163 <- .e129 + .e33
  .e166 <- .e152 + .e80 + .e9 + .e5
  .e167 <- .e50 * .e10
  .e168 <- .e157/.e4
  .e170 <- .e95 + .e143 + .e136
  .e171 <- .e128/.e3
  .e172 <- 3 * .e120
  .e173 <- .e145 * .e49
  .e174 <- .e168 + .e94
  .e175 <- 2 * .e23
  .e176 <- (.e86 + 2 * (.e117/.e3))/.e4
  .e177 <- .e69 + .e94
  .e178 <- .e150/.e3
  .e179 <- .e60 + .e56
  .e180 <- 2 * .e163
  .e181 <- (.e21 + .e137)/.e4
  .e185 <- .e45 + .e158/.e4 + .e167 + .e125 + .e56
  .e187 <- (6 + .e37)/.e4
  .e188 <- 2 * (.e8 * .e27)
  .e189 <- 4 * .e33
  .e192 <- .e139/.e4 + .e70 + .e52
  .e193 <- .e53 + .e187
  .e194 <- .e93 + .e22
  .e195 <- .e192/.e4
  .e197 <- .e36 + .e140 + .e188
  .e198 <- .e179/.e3
  .e199 <- 2 * .e75
  .e200 <- 2 * .e109
  .e201 <- ((.e166 + .e119) * .e8 + .e189 + .e142)/.e4
  .e202 <- .e185/.e3
  .e203 <- .e197 * .e40
  .e205 <- .e141 + .e22 + delta
  .e209 <- (.e176 + .e178)/.e4 + .e170/.e3 + (.e181 + .e171) * 
    .e47 + .e173
  .e210 <- .e92 + .e21
  .e212 <- .e1 * .e194/.e3
  .e213 <- .e27 * .e6
  .e214 <- .e148 + 54/.e4
  .e215 <- 2 * .e50
  .e216 <- 3 * .e107
  .e217 <- (.e162 + .e52 + .e96)/.e4
  .e219 <- .e54 + .e212 + .e140
  .e221 <- .e1 * .e214/.e3
  .e222 <- .e205 * .e27
  .e223 <- 2 * .e118
  .e224 <- .e210/.e4
  .e226 <- .e31 + .e85 + .e19
  .e227 <- 16/.e3
  .e228 <- 2 * .e128
  .e231 <- .e219/.e3
  .e232 <- .e227 + .e24
  .e233 <- 2 * .e111
  .e234 <- 2 * ((.e21 + .e33)/.e4 + .e112/.e3)
  .e235 <- 3 * delta
  .e236 <- 52/.e4
  .e237 <- .e156 * .e47
  .e238 <- .e156 * .e49
  .e240 <- .e82/.e3
  .e242 <- .e1 * (.e160 + .e74)/.e3
  .e243 <- 10/.e4
  .e246 <- .e159 + .e65 + .e9 + delta
  .e247 <- 2 * (.e89 + .e94)
  .e248 <- .e141 + .e38
  .e249 <- 3 * .e51
  .e250 <- 4 * .e21
  .e251 <- 4 * .e23
  .e252 <- .e34 * .e232
  .e253 <- .e89 + .e226/.e3
  .e254 <- .e26 + .e248 * .e27
  .e255 <- 2 * .e120
  .e256 <- .e177 * .e47
  .e258 <- (.e162 + .e172 + .e52)/.e4
  .e260 <- .e201 + .e202 + .e199
  .e261 <- .e139 * .e8
  .e263 <- .e102 + .e144 + .e39
  .e264 <- .e213 + 2 * .e63
  .e265 <- 2 * (.e224 + .e60/.e3)
  .e266 <- 2 * .e117
  .e267 <- 2 * .e154
  .e268 <- 6 * .e50
  .e269 <- .e209 * .e1
  .e270 <- .e174 * .e47
  .e271 <- .e174 * .e49
  .e272 <- .e195 + .e75
  .e273 <- .e75 + (.e117 * .e8 + .e64 + .e52)/.e4
  .e274 <- .e95 + .e258
  .e275 <- .e116 + .e255
  .e276 <- .e221 + 2 * .e122
  .e279 <- .e254 + .e266 + .e9 + .e5
  .e280 <- .e50 * .e30
  .e281 <- .e110 * .e27
  .e282 <- .e17 + .e5
  .e283 <- 6 * .e6
  .e284 <- 8 * .e27
  .e285 <- .e253 * .e1
  .e286 <- .e115/.e3
  .e287 <- .e177 * .e49
  .e288 <- (.e261 + .e57)/.e4
  .e290 <- .e95 + .e217 + .e263/.e3
  .e291 <- (.e45 + .e125 + .e20 + .e22)/.e3
  .e293 <- .e1 * .e246/.e3
  .e294 <- .e154 + .e228
  .e295 <- 2 * .e53
  .e296 <- 4 * .e43
  .e297 <- 9 * .e21
  .e298 <- .e285 + 2 * .e32
  .e300 <- .e145 * .e47 + .e260/.e3
  .e301 <- .e274 + .e143
  .e302 <- .e95/.e3
  .e303 <- .e231 + (.e57 + .e249)/.e4
  .e304 <- (.e166 + .e296 + .e251 + .e119)/.e4
  .e305 <- .e23 * .e282
  .e307 <- .e87 + .e144 + .e39
  .e308 <- .e294/.e3
  .e309 <- 2 * .e170
  .e310 <- 2 * .e43
  .e311 <- 3 * .e275
  .e312 <- .e78 + (.e158 + .e268 + .e123)/.e4
  .e313 <- .e45 + .e91
  .e315 <- .e26 + .e91 + .e9
  .e319 <- .e36 + .e222 + .e17 + .e9 + .e5
  .e320 <- (.e193 + .e125)/.e3
  .e322 <- .e3/.e4 + 2 * .e4
  .e323 <- 2 * .e150
  .e324 <- 2 * .e45
  .e325 <- 5 * .e21
  .e326 <- 6 * .e33
  .e327 <- .e270 + (.e272 + .e320)/.e3
  .e328 <- .e319 * .e8
  .e329 <- (.e106 + .e310 + .e175 + .e17)/.e4
  .e330 <- .e23 * .e40
  .e334 <- .e313 + .e20 + .e19
  .e335 <- (18 + .e104)/.e4
  .e336 <- .e113 * .e10
  .e337 <- .e281 + (.e131 + .e284)/.e4
  .e338 <- 2 * .e92
  .e339 <- 2 * (.e87 + .e98 + .e39)
  .e340 <- 2 * .e26
  .e341 <- 4 * .e76
  .e342 <- 6 * .e8
  .e344 <- (.e103 + .e291)/.e3 + .e256
  .e345 <- ((.e67 + .e175) * .e8 + .e57)/.e4
  .e346 <- .e288 + 2 * .e94
  .e347 <- .e273 + .e198
  .e348 <- (.e293 + .e335 + .e280 + .e17 + .e9)/.e4
  .e349 <- .e315/.e3
  .e350 <- .e328 + .e329
  .e353 <- .e1 * .e322/.e61 + 2
  .e355 <- .e1 * (.e243 + .e235 + .e93)/.e3
  .e362 <- .e1 * (.e79 + .e223 + .e9 + .e85)/.e3 + .e222 + 
    .e159 + .e223 + .e9 + .e119
  .e368 <- .e276 + 2 * .e307 + .e267 + .e148 + .e236
  .e369 <- .e337 * .e8
  .e370 <- .e50/.e4
  .e371 <- 2 * .e264
  .e372 <- .e5 + .e93
  .e373 <- 3 * .e75
  .e374 <- 4 * .e111
  .e375 <- 6 * .e90
  .e378 <- .e252 + .e368/.e3 + .e309
  .e379 <- (.e21 + .e129 + .e330)/.e4
  .e380 <- .e217 + 2 * (.e279/.e3)
  .e385 <- .e54 + .e340 + .e93
  .e386 <- (.e355 + .e80 + .e93 + .e19 + .e342) * .e8
  .e387 <- .e348 + .e369
  .e388 <- .e362 * .e8
  .e389 <- .e334/.e3
  .e391 <- (.e23 + .e216)/.e4
  .e397 <- .e242 + (.e215 + 4 + .e37)/.e4 + .e27 * .e372 + 
    .e91 + .e200 + .e160
  .e398 <- .e100 + .e101
  .e399 <- .e53 + 2 * (.e353/.e4)
  .e400 <- .e3^2
  .e401 <- 2 * .e209
  .e402 <- 2 * (.e271 + .e301/.e3)
  .e403 <- 2 * (.e201 + .e199 + 2 * .e202)
  .e404 <- 2 * (.e105 + .e22)
  .e405 <- 2 * .e193
  .e406 <- 3 * (.e116 + 2 * .e90)
  .e407 <- .e298 * .e84
  .e408 <- .e237 + .e300 * .e1
  .e413 <- .e378/.e3 + .e303 * .e84 + ((.e203 + .e391 + .e52)/.e4 + 
                                         .e308 + .e234) * .e47 + ((.e137 + .e305 + .e180 + .e325)/.e4 + 
                                                                    .e397/.e3) * .e49 + 2 * (.e290/.e3 + .e287)
  .e419 <- .e380/.e3
  .e420 <- (.e178 + 2 * .e176)/.e4
  .e421 <- .e345 + .e231
  .e422 <- .e195 + .e198
  .e423 <- .e385/.e3
  .e424 <- (.e386 + .e326 + .e297)/.e4
  .e425 <- (.e388 + .e304 + .e142 + .e375)/.e4
  .e427 <- .e387 + .e323 + .e406
  .e428 <- (.e312 + .e144 + .e404 + .e295 + .e39)/.e3
  .e430 <- .e146 + .e203 + .e133
  .e431 <- .e398/.e3
  .e432 <- (.e16 + .e175 + .e17 + .e216)/.e4
  .e437 <- .e242 + .e200 + 2 * .e370 + 2 * .e213 + .e160
  .e438 <- ((16 + .e37)/.e4 + .e336 + .e324 + .e56 + .e341)/.e3
  .e439 <- .e193 * .e8
  .e440 <- (.e399 + .e371)/.e3
  .e441 <- 2 * (.e286 + .e256)
  .e442 <- 2 * (.e286 + (.e240 + .e51/.e4) * .e47)
  .e443 <- 2 * (.e347/.e3 + (.e69 + .e264/.e3) * .e47)
  .e444 <- 2 * (.e287 + .e302)
  .e445 <- 2 * (.e87 + .e39)
  .e446 <- 2 * .e279
  .e447 <- 5 * .e51
  .e448 <- 6 * .e120
  .e450 <- ((.e419 + .e420)/.e4 + .e427/.e400)/.e4 + .e413/.e3
  .e454 <- .e407 + (.e430 + .e432 + .e96 + .e142)/.e4
  .e455 <- .e271 + .e302
  .e458 <- .e173 + (.e425 + .e428 + .e403)/.e3 + ((.e305 + 
                                                     .e180 + .e250)/.e4 + .e437/.e3) * .e47 + .e444
  .e460 <- .e303 * .e47 + (.e424 + .e438 + .e373)/.e3
  .e461 <- ((.e67 + .e216)/.e4 + .e203 + .e52)/.e4
  .e462 <- .e252 + (.e276 + .e339 + .e267 + .e148 + .e236)/.e3
  .e464 <- .e290 + .e136
  .e465 <- .e95 + (.e350 + .e52 + .e96)/.e4
  .e466 <- (.e70 + .e137 + .e64 + .e250)/.e4
  .e467 <- (.e78 + .e50 * .e29 + (20 + .e37 + .e123)/.e4 + 
              .e97 + .e144 + .e228)/.e3
  .e468 <- (.e45 + .e167 + (.e37 + 8)/.e4 + .e91 + .e56)/.e3
  .e469 <- .e129 + .e23 * (.e17 + .e38 + delta)
  .e470 <- (.e154 + .e144)/.e3
  .e472 <- (.e215 + .e104)/.e4 + .e27 * (.e93 + .e19)
  .e473 <- .e27 * (.e283 + .e22)
  .e474 <- (.e52 + .e447)/.e4
  .e475 <- 10 * .e11
  .e476 <- .e159 + .e9
  .e478 <- 14 * .e11 + .e215
  .e479 <- 2 * (.e269 + .e238 + .e181 + .e171)
  .e480 <- 2 * .e344
  .e481 <- 2 * (.e273 + 2 * .e198)
  .e482 <- 2 * .e70
  .e483 <- 24 * .e11
  .e484 <- 3 * .e23
  .e485 <- 7 * .e21
  .e491 <- .e450 * .e1 + (.e454 + .e467 + .e479 + .e136 + .e234)/.e3 + 
    (.e237 + .e460 * .e1 + .e349 + .e474 + .e247 + .e374) * 
    .e49 + .e401 + 2 * (.e464/.e3 + (.e379 + .e389) * 
                          .e47 + (.e132 + .e423) * .e49) + 2 * ((.e465 + .e470 + 
                                                                   .e481)/.e3 + (.e86 + .e440) * .e47 + (.e431 + 2 * .e69) * 
                                                                  .e49)
  .e493 <- .e269 + .e298 * .e49 + .e466
  .e496 <- .e327 * .e1 + .e168 + .e233
  .e500 <- .e238 + .e458 * .e1 + (.e469 + .e180 + .e52)/.e4 + 
    .e234 + 4 * .e240
  .e506 <- ((((.e1 * (.e79 + .e65 + .e85 + .e93)/.e3 + .e159 + 
                 .e65 + .e119 + .e93) * .e8 + .e133 + .e172 + .e326 + 
                .e297)/.e4 + (.e446 + 4 * .e117)/.e3)/.e4 + ((.e1 * (.e79 + 
                                                                       .e65 + .e85 + .e93)/.e3 + .e280 + (20 + .e104)/.e4 + 
                                                                .e119 + .e93)/.e4 + (.e246 * .e27 + (16 + 16 * .e11 + 
                                                                                                       .e284)/.e4) * .e8 + .e323 + .e311 + .e96)/.e3)/.e4 + 
    .e421 * .e84 + (.e461 + .e308 + .e265) * .e47 + (.e462 + 
                                                       .e309)/.e3 + ((.e137 + .e338 + .e180 + .e124 + .e325)/.e4 + 
                                                                       ((.e478 + 4)/.e4 + .e473 + .e91 + .e200)/.e3) * .e49 + 
    .e402
  .e509 <- .e346 * .e49 + .e422 * .e47
  .e510 <- (.e89 + (.e31 + .e235 + .e22)/.e3) * .e1
  .e511 <- (.e301 + .e136)/.e3
  .e512 <- ((.e152 + (.e475 + 12)/.e4 + (.e476 + .e141 + .e235) * 
               .e27 + .e9 + .e119) * .e8 + .e304 + .e448 + .e142)/.e4
  .e513 <- (.e312 + 2 * .e185 + .e98 + .e405 + .e295 + .e39)/.e3
  .e514 <- .e67 + .e484
  .e519 <- .e1 * (.e194 + delta)/.e3 + .e17 + .e93 + .e19
  .e520 <- (.e281 + (24 + .e483)/.e4) * .e8
  .e521 <- 2 * (.e270 + (.e272 + .e198)/.e3)
  .e522 <- 2 * .e327
  .e523 <- 2 * .e455
  .e524 <- 2 * .e300
  .e525 <- 24 * .e27
  .e526 <- 4 * .e51
  .e527 <- 4 * .e11
  .e528 <- 5/.e4
  .e529 <- .e491/.e3
  .e530 <- .e496 * .e47
  .e531 <- .e500/.e3
  .e532 <- (.e344 * .e1 + .e69 + .e233) * .e47
  .e533 <- .e506 * .e1
  .e535 <- .e238 + .e379 + .e389
  .e536 <- .e156 * .e84
  .e537 <- .e510 + 3 * .e32
  .e540 <- .e173 + (.e512 + .e513 + 2 * .e260)/.e3 + ((.e472 + 
                                                         .e200)/.e3 + (.e338 + .e180 + .e124 + .e250)/.e4) * .e47 + 
    .e523
  .e544 <- .e95 + (.e350 + .e172 + .e52)/.e4
  .e545 <- (.e135 * (.e85 + .e22) + .e43 * (.e243 + delta) + 
              .e520 + .e64 + .e172 + .e52 + .e311 + .e96)/.e4
  .e546 <- (.e137 + .e482 + .e189 + .e485)/.e4
  .e547 <- .e23 * .e6
  .e553 <- .e293 + .e243 + .e17 + .e65 + .e9
  .e554 <- .e78 + .e59
  .e555 <- ((14 + .e37)/.e4 + .e336 + .e91 + .e324 + .e125 + 
              .e56)/.e3
  .e556 <- (.e154 + 2 * .e179 + .e98)/.e3
  .e558 <- .e62 * .e27 + (.e525 + 4 + .e37)/.e4
  .e559 <- 12 * .e11
  .e560 <- 2 * ((((.e11 + 6) * .e8 + .e1 * (.e114 + 7/.e4)/.e3 + 
                    .e9 + .e5)/.e4 + .e52)/.e4 + .e307/.e3)
  .e561 <- 2 * .e253
  .e562 <- 2 * (.e103 + 2 * .e291)
  .e563 <- 2 * .e240
  .e564 <- 2 * (.e519/.e4 + .e439)
  .e565 <- 2 * .e226
  .e566 <- 3 * .e14
  .e567 <- 4 * .e30
  .e568 <- 8 * .e21
  .e569 <- .e529 + (.e531 + .e532 + .e480 + .e441 + .e524) * 
    .e47
  .e577 <- (.e269 + .e537 * .e49 + .e546 + .e555)/.e3 + (.e408 + 
                                                           .e349 + (.e57 + .e526)/.e4 + .e233 + .e247) * .e47 + 
    .e442 + .e443
  .e578 <- .e535/.e3
  .e582 <- ((((.e139 + .e175)/.e4 + .e482 + .e142)/.e4 + (.e45 + 
                                                            (12 + .e37)/.e4 + .e167 + .e341)/.e3 + .e199)/.e3 + .e346 * 
              .e47) * .e1 + .e288 + .e374
  .e583 <- .e238 + .e540 * .e1
  .e584 <- .e421 * .e47
  .e592 <- .e509 + (.e274 + (.e554 + .e405 + .e39)/.e3 + .e562)/.e3
  .e594 <- .e346 * .e84 + .e422 * .e49
  .e596 <- (.e514 * .e8 + .e52)/.e4 + (.e54 + .e1 * (.e283 + 
                                                       .e74)/.e3 + (.e18 + 8) * .e6)/.e3
  .e597 <- (.e514/.e4 + .e58 * (.e85 + .e528) + .e330 + .e439 + 
              .e52)/.e4
  .e599 <- .e224 + .e171
  .e601 <- .e252 + .e545 + (.e221 + 2 * .e263 + .e339 + .e445 + 
                              .e148 + .e236)/.e3
  .e602 <- (.e139 + .e251)/.e4
  .e603 <- .e553 * .e8
  .e604 <- (.e87 + 2 * .e334 + .e39)/.e3
  .e605 <- (.e127 + (2 * (.e7 + .e17) + .e9) * .e27 + 2 * (.e113/.e4) + 
              .e65) * .e40
  .e606 <- .e23 * (.e5 + 5 * .e8)
  .e607 <- (.e1 * .e130/.e3 + .e8 * .e113)/.e4
  .e611 <- .e36 + .e310
  .e614 <- (.e91 + .e340 + .e93)/.e3
  .e615 <- .e60 + 2 * .e315
  .e616 <- .e10 * (.e527 + 6)
  .e617 <- 2 * ((.e493 + .e468)/.e3 + (.e408 + (.e21 + .e249)/.e4 + 
                                         .e233 + .e247 + .e563) * .e47 + .e442 + .e443)
  .e618 <- 2 * (.e493 + 2 * .e468)
  .e619 <- 2 * (((.e210 + .e129 + .e547)/.e4 + .e171) * .e47 + 
                  ((.e261 + .e21)/.e4 + .e423) * .e49 + .e511)
  .e620 <- 2 * ((.e288 + .e431) * .e49 + (.e195 + .e440) * 
                  .e47 + (.e544 + .e556 + 2 * .e347)/.e3)
  .e621 <- 2 * (.e509 + .e511)
  .e622 <- 2 * (.e224 + .e472/.e3)
  .e623 <- 2 * .e157
  .e624 <- 2 * .e219
  .e625 <- 2 * (.e154/.e3 + .e265)
  .e626 <- 2 * .e147
  .e627 <- 2 * .e113
  .e628 <- .e20 + .e160
  .e629 <- 2 * .e205
  .e630 <- 24/.e4
  .e631 <- 3 * .e163
  .e632 <- 3 * (.e26 + .e370 + .e188 + .e9)
  .e633 <- 4 * .e120
  .e634 <- 4 * delta
  .e635 <- 5 * .e163
  .e636 <- 6 * .e23
  delta * ((0-1i) * (0+1i) * (((((((((.e388 + 2 * .e304 + .e142 + 
                                        .e375)/.e4 + ((10 + .e475)/.e4 + (.e9 + .e141 + .e85 + 
                                                                            9/.e4) * .e27 + 4 * .e135 + 4 * .e58)/.e3)/.e4 + (.e362/.e4 + 
                                                                                                                                ((.e223 + .e629 + .e9 + .e85 + 28/.e4) * .e27 + (40 + 
                                                                                                                                                                                   40 * .e11)/.e4) * .e8 + .e448 + 6 * .e275)/.e3)/.e4 + 
                                     .e145 * .e84 + ((.e58 * .e282 + .e23 * (.e17 + .e22) + 
                                                        .e180 + .e564 + .e633 + .e250)/.e4 + ((16 + 2 * (.e18 + 
                                                                                                           2 * .e27 + 4) + .e483)/.e4 + (.e628 + .e74) * .e27 + 
                                                                                                2 * .e437)/.e3 + .e622) * .e47 + ((.e23 * (.e5 + .e119) + 
                                                                                                                                     .e338 + 4 * .e163 + .e568)/.e4 + (.e242 + .e27 * (.e19 + 
                                                                                                                                                                                         .e283) + (4 * .e50 + .e104)/.e4 + .e160 + 4 * .e109)/.e3) * 
                                     .e49 + ((.e221 + (36 * .e27 + 46 + .e37 + .e268)/.e4 + 
                                                .e445 + 2 * (.e554 + .e39) + .e626 + .e148)/.e3 + 2 * 
                                               (.e425 + .e403 + 2 * .e428))/.e3 + 2 * (.e594 + .e34 * 
                                                                                         (.e227 + 2 * .e84 + .e24)/.e3) + 2 * ((.e512 + 2 * .e513)/.e3 + 
                                                                                                                                 .e523)) * .e1 + .e536 + (.e58 * (.e17 + .e85 + .e528) + 
                                                                                                                                                            .e23 * (.e17 + .e74 + delta) + .e439 + .e180 + .e564 + 
                                                                                                                                                            .e172 + .e52)/.e4 + 2 * .e500 + .e560 + 4 * .e599)/.e3 + 
                                   .e582 * .e49 + .e621 + 2 * .e592 + 2 * .e458 + 2 * .e540)/.e3 + 
                                  ((.e592 * .e1 + .e195)/.e3 + .e522 + .e480) * .e47) * 
                                 .e47 + (((((((.e203 + 2 * .e391 + .e52)/.e4 + (.e58 + 
                                                                                  .e632)/.e3)/.e4 + (.e605 + .e172 + 3 * (.e197/.e4))/.e3)/.e4 + 
                                              ((.e558 + 2 * .e294)/.e3 + .e560 + .e625)/.e3) * .e47 + 
                                             (.e596 * .e232 + ((.e92 + .e137 + .e606 + .e255 + .e635 + 
                                                                  .e568)/.e4 + (.e242 + (10 * .e6 + .e74) * .e27 + 
                                                                                  (.e215 + .e627 + 20 * .e11 + 4)/.e4 + .e91 + .e200 + 
                                                                                  .e624 + .e160)/.e3) * .e84 + (.e34 * (32/.e3 + .e24) + 
                                                                                                                  ((160 + 162 * .e11)/.e4 + .e214 * .e27 + 2 * .e368 + 
                                                                                                                     2 * (.e221 + .e339 + .e267 + .e148 + .e236) + 
                                                                                                                     2 * (.e221 + .e445 + .e148 + .e236) + 2 * .e558)/.e3 + 
                                                                                                                  2 * .e378)/.e3 + ((.e43 * .e282 + (.e23 + .e251 + 
                                                                                                                                                       6 * .e107)/.e4 + .e180 + 2 * .e203 + .e564 + 5 * 
                                                                                                                                       .e120 + .e568)/.e4 + ((16 * .e27 + .e215 + 24 + 36 * 
                                                                                                                                                                .e11)/.e4 + (.e628 + 2 * .e372 + .e630) * .e27 + 
                                                                                                                                                               2 * .e397 + .e228)/.e3 + .e622 + .e265 + .e234) * 
                                                .e49 + 2 * (.e174 * .e84 + .e462/.e3 + .e402) + 2 * 
                                                (.e594 + (.e601 + 2 * .e290)/.e3) + 2 * .e413)/.e3)/.e3 + 
                                            (((((.e293 + .e280 + 2 * .e335 + .e17 + .e9)/.e4 + 8 * 
                                                  (.e27/.e3))/.e4 + ((.e476 + .e567 + delta) * .e27 + 
                                                                       (32 * .e11 + 6 + 8 * .e50)/.e4)/.e3)/.e4 + (((2 * 
                                                                                                                       .e110 + .e630) * .e27 + (32 * .e27 + 8 + .e104)/.e4) * 
                                                                                                                     .e8 + .e337/.e4 + 2 * (.e387 + .e311) + 3 * (.e553/.e4 + 
                                                                                                                                                                    2 * .e275) + 4 * .e427)/.e3)/.e400 + ((.e545 + 2 * 
                                                                                                                                                                                                             .e380 + 2 * (((11/.e4 + 2 * .e248 + .e9) * .e27 + 
                                                                                                                                                                                                                             .e187 + .e446 + 2 * (.e254 + .e9 + .e5))/.e3))/.e400 + 
                                                                                                                                                                                                            (((2 * .e348 + 2 * .e369 + .e311 + .e406 + 4 * .e150)/.e3 + 
                                                                                                                                                                                                                2 * (((.e603 + .e133 + .e172 + .e189 + .e142)/.e4 + 
                                                                                                                                                                                                                        (.e446 + .e266)/.e3)/.e4))/.e3 + (2 * .e419 + 
                                                                                                                                                                                                                                                            3 * .e420)/.e4)/.e4)/.e4)/.e4) * .e1 + (((.e596 * 
                                                                                                                                                                                                                                                                                                        .e47 + (((.e139 + .e636)/.e4 + (.e1 * (14/.e4 + .e634 + 
                                                                                                                                                                                                                                                                                                                                                 .e283)/.e3 + .e80 + .e283 + .e22 + 8 * .e8) * .e8 + 12 * 
                                                                                                                                                                                                                                                                                                                   .e21)/.e4 + ((.e559 + 24)/.e4 + .e10 * (.e527 + 8) + 
                                                                                                                                                                                                                                                                                                                                  .e324 + .e565 + .e56 + .e341)/.e3 + 4 * .e75)/.e3) * 
                                                                                                                                                                                                                                                                                                       .e1 + .e237 + .e349 + (.e623 + .e52 + .e447)/.e4 + .e561 + 
                                                                                                                                                                                                                                                                                                       .e247 + .e374) * .e84 + (.e298 * .e232 + (.e221 + (18 * 
                                                                                                                                                                                                                                                                                                                                                            .e50 + 20 + .e525 + .e37)/.e4 + .e339 + .e445 + .e626 + 
                                                                                                                                                                                                                                                                                                                                                   .e148)/.e3 + 2 * (.e454 + .e479 + .e136 + .e234 + 2 * 
                                                                                                                                                                                                                                                                                                                                                                       .e467) + .e560 + .e625)/.e3 + (((.e430 + 2 * .e432 + 
                                                                                                                                                                                                                                                                                                                                                                                                          .e96 + .e142)/.e4 + (.e632 + 3 * .e58)/.e3)/.e4 + (.e605 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                               .e135 * (.e528 + delta) + .e520 + (3 * .e197 + .e296)/.e4 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                               .e311 + .e448)/.e3)/.e4 + 2 * ((.e533 + .e536 + .e461 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 .e308 + .e265)/.e3 + .e496 * .e49 + .e401) + 2 * .e491 + 
                                                                                                                                                                                                                                                                                                      2 * .e506 + 2 * ((.e345 + (.e54 + 3 * .e26 + .e283)/.e3) * 
                                                                                                                                                                                                                                                                                                                         .e84 + (.e597 + .e604 + .e265) * .e47 + (.e601 + 2 * 
                                                                                                                                                                                                                                                                                                                                                                    .e464)/.e3 + ((.e469 + (14 + 2 * .e13 + .e566)/.e3 + 
                                                                                                                                                                                                                                                                                                                                                                                     .e338 + .e180)/.e4 + (.e313 + 2 * .e385 + 2 * (.e53 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                      6 * .e63) + .e20 + .e19)/.e3) * .e49 + .e402) + .e402)/.e3 + 
                                           (((((.e92 + .e606 + .e255 + .e635 + .e485)/.e4 + (.e242 + 
                                                                                               (.e478 + .e627)/.e4 + .e27 * (.e22 + 8 * .e6) + .e200 + 
                                                                                               .e624 + .e160)/.e3) * .e47 + (((.e1 * (.e243 + .e79 + 
                                                                                                                                        .e223 + .e85 + .e235 + .e283)/.e3 + (.e79 + .e141 + 
                                                                                                                                                                               .e93 + .e634) * .e27 + (18 * .e11 + 22)/.e4 + .e222 + 
                                                                                                                                 .e159 + .e223 + .e9 + .e119 + .e93 + .e342) * .e8 + 
                                                                                                                                (.e355 + .e152 + .e80 + .e80 + 10 * .e43 + .e9 + 
                                                                                                                                   .e5 + .e251 + .e119 + .e93 + .e19 + .e636 + .e342)/.e4 + 
                                                                                                                                15 * .e21 + .e375 + 9 * .e120)/.e4 + (.e78 + (.e559 + 
                                                                                                                                                                                12 * .e27 + 26 + .e268 + 6 * .e113)/.e4 + 2 * (.e78 + 
                                                                                                                                                                                                                                 .e39) + .e144 + .e404 + .e98 + .e39 + 4 * .e193 + 
                                                                                                                                                                        4 * .e53)/.e3 + 2 * (.e424 + 2 * .e438 + .e373) + 
                                                                                                                               .e403)/.e3 + ((.e1 * (.e243 + .e283)/.e3 + (10 + 
                                                                                                                                                                             .e527) * .e6 + 2 * .e54)/.e3 + .e474) * .e49 + .e444 + 
                                                3 * .e455) * .e1 + (.e129 + .e23 * (.e38 + 7 * .e8 + 
                                                                                      delta) + .e172 + .e142 + 7 * .e163)/.e4 + (.e615 + 
                                                                                                                                   4 * .e82)/.e3 + 2 * .e238 + .e265 + .e234)/.e3 + 
                                              .e582 * .e47 + .e521 + .e480 + .e441 + .e524 + 2 * 
                                              .e460 + 4 * .e327) * .e49 + 2 * .e450 + 2 * (((((.e328 + 
                                                                                                 2 * .e329 + .e52 + .e96)/.e4 + (.e254 + 2 * .e135 + 2 * 
                                                                                                                                   .e58 + .e9 + .e5)/.e3)/.e4 + ((.e127 + (.e159 + .e629) * 
                                                                                                                                                                    .e27 + .e65 + .e74) * .e8 + .e319/.e4 + .e172 + .e311)/.e3)/.e4 + 
                                                                                              ((.e157 + 2 * .e68)/.e4 + (.e212 + .e140)/.e3) * .e84 + 
                                                                                              (.e252 + (.e558 + .e445)/.e3 + 2 * (.e465 + .e481 + 2 * 
                                                                                                                                    .e470))/.e3 + ((.e70 + 2 * .e192 + .e64 + .e52)/.e4 + 
                                                                                                                                                     ((2 * .e353 + .e215 + .e104)/.e4 + .e473 + 2 * .e398 + 
                                                                                                                                                        .e371)/.e3) * .e49 + 2 * (.e271 + (.e544 + 2 * .e556)/.e3))/.e3 + 
                                                                                             ((.e258 + (.e147 + 2 * .e399 + 2 * (.e53 + .e371))/.e3)/.e3 + 
                                                                                                2 * ((.e1 * (2 * (.e322^2/.e3) - 3)/.e4 + 4 * .e322)/.e61^2)) * 
                                                                                             .e47))/.e3) * .e1 + ((((.e533 + .e537 * .e84 + ((.e1 * 
                                                                                                                                                (.e9 + 20/.e4 + .e567 + delta)/.e3 + .e59 + .e17 + .e9 + 
                                                                                                                                                .e567) * .e8 + .e203 + (.e611 + .e17 + .e9 + .e5 + .e216 + 
                                                                                                                                                                          .e251)/.e4 + .e133 + 7 * .e120 + .e485)/.e4 + ((26 + 
                                                                                                                                                                                                                            .e37 + .e268 + .e123)/.e4 + 2 * .e78 + .e98 + .e405 + 
                                                                                                                                                                                                                           .e295 + 4 * .e29)/.e3 + .e618 + .e265 + .e562)/.e3 + 
                                                                                                                      ((.e584 + ((.e602 + .e386 + .e297)/.e4 + (.e45 + (.e559 + 
                                                                                                                                                                          18)/.e4 + .e616 + .e565 + .e125 + .e56)/.e3 + .e373)/.e3) * 
                                                                                                                         .e1 + .e237 + (.e57 + 3 * .e157 + .e526)/.e4 + .e614 + 
                                                                                                                         .e561 + .e233 + .e247) * .e49 + .e401 + .e619 + .e620)/.e3 + 
                                                                                                                     .e529 + (.e530 + .e531 + (.e583 + ((.e43 + .e484) * .e8 + 
                                                                                                                                                          .e607 + .e631 + .e142)/.e4 + .e615/.e3 + .e265)/.e3 + 
                                                                                                                                .e532 + .e521 + .e522 + .e480 + .e441 + 4 * .e300) * 
                                                                                                                     .e47) * .e1 + (.e577 * .e1 + .e237 + .e132 + .e240 + 
                                                                                                                                      .e233 + .e247) * .e47 + .e530 + .e578 + (.e238 + (.e547 + 
                                                                                                                                                                                          .e519 * .e8 + .e607 + .e250)/.e4 + .e171)/.e3 + .e617 + 
                                                                                                                    2 * .e577 + .e521 + .e522 + .e441) * .e47 + ((((.e269 + 
                                                                                                                                                                      (.e510 + .e16 + 4 * .e14 * .e8) * .e49 + .e195 + .e546 + 
                                                                                                                                                                      .e555 + .e320)/.e3 + (.e408 + (.e153 + .e566/.e3 + .e526)/.e4 + 
                                                                                                                                                                                              .e614 + .e233 + .e247) * .e47 + .e442 + .e443) * .e1 + 
                                                                                                                                                                    .e237 + .e345 + .e240 + .e247 + .e374) * .e49 + (.e536 + 
                                                                                                                                                                                                                       .e597 + .e604 + 2 * .e535 + .e265)/.e3 + .e621)/.e3 + 
                                2 * (((.e533 + .e407 + (.e603 + .e203 + (.e611 + .e175 + 
                                                                           .e17 + .e9 + .e5 + .e216)/.e4 + .e633 + .e250)/.e4 + 
                                         (.e78 + (.e37 + .e268 + .e123 + 8)/.e4 + .e98 + .e295 + 
                                            .e39)/.e3 + .e618 + .e265)/.e3 + ((.e584 + ((.e602 + 
                                                                                           (.e1 * (.e85 + .e93 + .e19 + .e22 + delta)/.e3 + 
                                                                                              .e80 + .e17 + .e9 + .e9 + .e5 + .e5 + .e119) * 
                                                                                           .e8 + .e297)/.e4 + (.e45 + (12 * .e1/.e3 + 18)/.e4 + 
                                                                                                                 .e616 + .e565 + .e125 + .e56)/.e3 + .e373)/.e3) * 
                                                                                .e1 + .e237 + (.e21 + .e623 + .e249)/.e4 + .e561 + 
                                                                                .e233 + .e247 + .e563) * .e49 + .e401 + .e619 + .e620)/.e3 + 
                                       (.e530 + (.e583 + (.e92 + .e52 + .e631 + .e249)/.e4 + 
                                                   2 * .e599)/.e3 + .e521 + .e522 + .e524) * .e47) + 
                                2 * .e569) * .e1 + (1+0i) * (.e569 * .e1 + (((.e269 + 
                                                                                (.e285 + .e16 + .e566 * .e8) * .e49 + .e466 + .e86 + 
                                                                                .e468 + .e291)/.e3 + (.e408 + (.e51 + 2 * .e14/.e3 + 
                                                                                                                 .e249)/.e4 + .e349 + .e233 + .e247) * .e47 + .e442 + 
                                                                               .e443) * .e1 + .e237 + (.e21 + .e175 * .e8)/.e4 + .e240 + 
                                                                              .e233 + .e247) * .e47 + .e578 + .e617 + .e441)) * exp(-(delta * 
                                                                                                                                        (.e4 - sqrt(.e2 - beta^2))))/.e3
}


ps=c(75,90,99)/100
resNIG=matrix(numeric(length(ps)*11),ncol=11)
for(i in 1:length(ps)){
  p=ps[i]
  Finv_p=HInv(p,abN(10^-9)[1],abN(10^-9)[2],10^7,10^-9) #F^-1(p)
  myabN=abN(eps_global)
  a=myabN[1]
  b=myabN[2]
  N=myabN[3]
  y=HInv(p,a,b,N,eps_global) #H^-1(p)
  H_y=H(y,a,b,N) #H(y)
  F_y=H(y,abN(10^-9)[1],abN(10^-9)[2],10^7) #F(y)
  
  resNIG[i,1]=eps_global
  resNIG[i,2]=b-a
  resNIG[i,3]=N
  resNIG[i,4]=p
  resNIG[i,5]=y
  resNIG[i,6]=abs(H_y-F_y)
  resNIG[i,7]=abs(y-Finv_p)
  resNIG[i,8]=min(h(y-eps_global,a,b,N),h(y+eps_global,a,b,N))
  resNIG[i,9]=2*eps_global/resNIG[i,8]+eps_global
  resNIG[i,10]=H(y,abN(10^-9)[1],abN(10^-9)[2],10^7)
  resNIG[i,11]=HGP(y,F)
}
resNIG=as.data.frame(resNIG)
names(resNIG)=c("eps","b-a","N","p", "y","abs(H_y-F_y)",
                "abs(y-Finv_p)","h(y)","RHS","F_y_COS_ref","F_y_GP_ref")
resNIG$DIS="NIG"
############################
#### tempered stable #######
############################
aTS=1
bTS=1
kappa=3/4
mu=2*aTS*kappa*bTS^((kappa-1)/kappa)
phi= function(u){exp(aTS*bTS-aTS*(bTS^(1/kappa)-2*1i*u)^kappa)*exp(-1i*u*mu)}
phi1=Deriv(phi,"u")
phi2=Deriv(phi1,"u")
phi3=Deriv(phi2,"u")
phi4=Deriv(phi3,"u")
#phi5=Deriv(phi4,"u")
#phi6=Deriv(phi5,"u")
#phi7=Deriv(phi6,"u")
#phi8=Deriv(phi7,"u")
phi8=function (u) {
  .e4 <- bTS^(1/kappa) - (0+2i) * u
  .e5 <- kappa - 1
  .e6 <- kappa - 2
  .e7 <- .e4^.e5
  .e8 <- (0-1i) * mu
  .e10 <- (0-2i) * aTS * kappa
  .e11 <- .e8 - .e10 * .e7
  .e12 <- kappa - 3
  .e13 <- .e4^.e6
  .e15 <- (-4+0i) * aTS * kappa
  .e16 <- .e4^.e12
  .e17 <- kappa - 4
  .e21 <- .e11^2 - .e15 * .e13 * .e5
  .e25 <- (0-2i) * .e16 * .e6 + 2 * (.e11 * .e13)
  .e26 <- aTS * kappa
  .e27 <- 2 * .e6
  .e28 <- .e4^.e17
  .e29 <- 2 * kappa
  .e30 <- (0-2i) * .e11
  .e31 <- .e4^2
  .e32 <- kappa - 5
  .e37 <- .e30 * .e16 * .e6 - .e15 * .e4^.e27 * .e5
  .e38 <- .e6/.e4
  .e39 <- .e26 * .e7
  .e40 <- .e15 * .e25
  .e41 <- .e21 * .e31
  .e44 <- (-4+0i) * .e28 * .e6 * .e12
  .e45 <- 2 * .e37
  .e46 <- .e4^.e32
  .e47 <- .e27 - 1
  .e48 <- .e29 - 5
  .e49 <- .e44 + .e45
  .e50 <- .e8 + (0-2i) * (.e38 - .e39)
  .e51 <- (0-2i) * .e21
  .e52 <- .e21 * .e50
  .e53 <- .e29 - 6
  .e55 <- (-12+0i) * aTS * kappa
  .e59 <- 2 * .e51 - .e40 * .e4 * .e5
  .e60 <- kappa - 6
  .e61 <- .e6/.e31
  .e63 <- .e26 * .e13 * .e5
  .e66 <- .e4^.e48 + 2 * .e4^.e47
  .e69 <- .e52 - .e55 * .e25 * .e5
  .e70 <- .e11 * .e25
  .e71 <- .e4^.e53
  .e72 <- .e4^.e60
  .e73 <- .e21 * .e11
  .e74 <- .e61 + .e63
  .e76 <- (.e73 - .e40 * .e5) * .e11
  .e79 <- .e11 * .e28 * .e12 - .e10 * .e66 * .e5
  .e80 <- 3 * .e41
  .e81 <- .e21 * .e74
  .e84 <- (0-2i) * .e46 * .e12 * .e17
  .e85 <- .e27 - 2
  .e86 <- .e29 - 7
  .e87 <- .e4^3
  .e88 <- .e38 + mu
  .e89 <- .e4^.e86
  .e91 <- (-20+0i) * .e6 * .e12
  .e94 <- .e48 * .e71 + 2 * (.e47 * .e4^.e85)
  .e97 <- .e49 * .e4
  .e98 <- .e41 + 2 * ((-4+0i) * .e6 * .e12)
  .e99 <- (0-2i) * .e25
  .e100 <- 2 * .e41
  .e102 <- .e26 * .e16 * .e5
  .e104 <- (-12+0i) * .e6 * .e12
  .e105 <- .e88 - 2 * .e39
  .e106 <- 2 * .e38
  .e107 <- 2 * mu
  .e109 <- .e102 - 2/.e87
  .e110 <- kappa - 7
  .e111 <- .e104 + .e100
  .e112 <- .e91 + .e80
  .e115 <- (-24+0i) * .e6 * .e12 + .e80
  .e125 <- (.e76 - .e15 * (.e44 + .e21 * .e13 + .e70 + .e45) * 
              .e5) * .e11
  .e126 <- .e69 * .e6
  .e127 <- (0-2i) * ((-4+0i) * .e46 * .e12 * .e17 + 2 * (.e30 * 
                                                           .e28 * .e12 - .e15 * .e66 * .e5))
  .e128 <- (0-2i) * .e69
  .e130 <- .e51 * .e109 * .e6
  .e131 <- (0-2i) * .e59
  .e132 <- .e84 + 2 * .e79
  .e134 <- (0-2i) * .e6 + (0-6i)
  .e135 <- .e59 * .e12
  .e137 <- (20+0i) * aTS * kappa
  .e138 <- .e4^.e110
  .e139 <- .e106 + .e107
  .e140 <- 3 * .e39
  .e141 <- 6 * .e37
  .e143 <- .e55 * .e49 * .e5
  .e147 <- (-24+0i) * aTS * kappa * .e49 * .e5
  .e148 <- (-4+0i) * (.e81 + .e26 * .e50 * .e25 * .e5)
  .e152 <- (-4+0i) * .e72 * .e12 * .e17 * .e32
  .e157 <- .e111 * .e28
  .e159 <- .e112 * .e17/.e87
  .e160 <- .e115 * .e28
  .e161 <- .e76 + .e128 * .e6/.e4
  .e164 <- .e52 + .e137 * .e25 * .e5
  .e165 <- .e21 * .e105
  .e167 <- (.e30 * .e46 * .e17 - .e15 * .e71 * .e5) * .e12 - 
    .e15 * .e94 * .e5
  .e169 <- .e25 * .e134 + 2 * .e97
  .e170 <- .e8 + (0-2i) * (.e88 - .e140)
  .e175 <- (0-2i) * .e72 * .e12 * .e17 * .e32 + 2 * ((.e11 * 
                                                        .e46 * .e17 - .e10 * .e71 * .e5) * .e12 - .e10 * .e94 * 
                                                       .e5)
  .e176 <- (0-8i) * .e21
  .e177 <- .e135/.e4
  .e178 <- .e59/.e4
  .e179 <- .e47 * .e85
  .e180 <- .e48 * .e53
  .e181 <- .e4^(.e29 - 8)
  .e182 <- 12 * .e37
  .e183 <- 2 * .e81
  .e184 <- .e27 - 3
  .e187 <- .e26 * .e25 * .e13 * .e5
  .e188 <- .e143 + .e148
  .e190 <- (-36+0i) * .e6 * .e12
  .e192 <- (-4+0i) * .e69/.e4
  .e193 <- .e15 * (.e97 + (0-6i) * .e25)
  .e195 <- .e69 * .e13
  .e197 <- .e164 * .e4 + .e176
  .e200 <- .e52 + (0-2i) * (.e159 + .e165) + (28+0i) * aTS * 
    kappa * .e25 * .e5 + 3 * .e178
  .e201 <- (.e84 + 12 * .e79) * .e6
  .e202 <- (0-2i) * .e98
  .e204 <- (0+8i) * .e175 * .e6
  .e205 <- .e177 + 2 * .e126
  .e208 <- .e180 * .e89 + 2 * (.e179 * .e4^.e184)
  .e209 <- .e139 - 4 * .e39
  .e210 <- 2 * .e61
  .e211 <- 3 * .e70
  .e212 <- 3 * .e38
  .e213 <- 5 * .e41
  .e214 <- 5 * .e39
  .e222 <- (-28+0i) * .e6 * .e12
  .e224 <- (-36+0i) * .e132 + .e127
  .e225 <- .e190 + .e80
  .e229 <- (-36+0i) * aTS * kappa * .e49 * .e5
  .e230 <- (-4+0i) * .e98
  .e231 <- (-4+0i) * (.e201 - .e25 * (.e210 + 5 * .e63))
  .e237 <- (-4+0i) * .e138 * .e12 * .e17 * .e32 * .e60 + 2 * 
    (((.e30 * .e72 * .e32 - .e15 * .e89 * .e5) * .e17 - .e15 * 
        .e53 * .e89 * .e5) * .e12 - .e15 * .e208 * .e5)
  .e239 <- .e193 * .e5 + .e131/.e4
  .e246 <- (-44+0i) * .e6 * .e12 + .e213
  .e249 <- ((-16+0i) * .e6 * .e12 + .e41) * .e28 + .e70 + 8 * 
    .e37
  .e251 <- .e160 + .e182 + .e211
  .e252 <- .e49 * .e170
  .e253 <- (.e125 - .e15 * ((.e98 * .e28 + .e70 + 4 * .e37) * 
                              .e11 + .e195 + .e127 * .e6) * .e5) * .e11
  .e254 <- (.e76 + (0-2i) * .e205/.e4 - (.e147 + (-4+0i) * 
                                           (.e183 + .e26 * (.e160 + (.e8 + (0-2i) * (.e139 - .e214)) * 
                                                              .e25 + .e182) * .e5))) * .e13
  .e256 <- .e197 * .e31 + (0-2i) * (.e91 + .e100) * .e17
  .e258 <- .e200 * .e13
  .e259 <- .e169 * .e16
  .e260 <- (0-2i) * .e49
  .e261 <- (0-2i) * (.e161 - (.e147 + (-4+0i) * (.e183 + .e26 * 
                                                   (.e157 + .e99 * .e209 + .e141) * .e5)))
  .e266 <- .e130 + 2 * (.e130 - .e40 * .e74 * .e5)
  .e268 <- (0-2i) * (.e202 * .e72 * .e32 + .e59 * .e28) * .e17
  .e269 <- .e131 * .e46
  .e270 <- .e10 * .e53
  .e271 <- 18 * .e167
  .e272 <- 18 * .e37
  .e273 <- 2 * .e152
  .e274 <- 3 * .e126
  .e275 <- 3 * .e81
  .e277 <- .e212 + 4 * mu - 8 * .e39
  .e278 <- 3 * .e59
  .e279 <- 5 * .e187
  (((.e253 - .e15 * (((-4+0i) * ((.e84 + 6 * .e79) * .e6 - 
                                   .e187) + ((.e104 + .e41) * .e28 + .e70 + .e141) * .e11 + 
                        .e195 + .e202 * .e46 * .e17 + .e59 * .e16) * .e11 + (.e161 - 
                                                                               (.e143 + (-4+0i) * (.e81 + .e26 * (.e157 + .e170 * .e25 + 
                                                                                                                    .e141) * .e5))) * .e13 + .e204) * .e5) * .e11 - .e15 * 
      (((-4+0i) * ((.e152 + 6 * .e167) * .e6 - .e26 * .e169 * 
                     .e16 * .e5) + ((-4+0i) * (.e201 - 2 * .e187) + .e249 * 
                                      .e11 + .e256 * .e46) * .e11 + .e254 + .e268 + .e204) * 
         .e11 + (.e125 + (.e261 - .e192) * .e6/.e4 - (-4+0i) * 
                   (.e130 + .e26 * (.e231 + ((-12+0i) * .e132 + .e127) * 
                                      .e6 + .e252 + .e251 * .e11 + .e258) * .e5)) * 
         .e13 + (0+8i) * .e237 * .e6) * .e5) * .e11 - .e15 * 
      (((-4+0i) * ((-4+0i) * ((0-2i) * .e138 * .e12 * .e17 * 
                                .e32 * .e60 + 6 * (((.e11 * .e72 * .e32 - .e10 * 
                                                       .e89 * .e5) * .e17 - .e270 * .e89 * .e5) * .e12 - 
                                                     .e10 * .e208 * .e5)) * .e6 - .e26 * ((.e49 * .e134 + 
                                                                                             2 * ((-4+0i) * .e132 * .e4 * .e6 + .e260)) * .e16 + 
                                                                                            (0-2i) * .e169 * .e28 * .e12) * .e5) + ((-4+0i) * 
                                                                                                                                      ((.e271 + .e273) * .e6 - .e26 * (.e249 * .e13 + .e259 + 
                                                                                                                                                                         2 * (.e49 * .e13 + .e99 * .e16 * .e6)) * .e5) + 
                                                                                                                                      (.e230 * .e72 * .e32 + .e131 * .e28) * .e17 + ((-4+0i) * 
                                                                                                                                                                                       ((.e84 + 20 * .e79) * .e6 - .e279) + ((.e91 + .e41) * 
                                                                                                                                                                                                                               .e28 + .e70 + 10 * .e37) * .e11 + ((.e73 + (16+0i) * 
                                                                                                                                                                                                                                                                     aTS * kappa * .e25 * .e5) * .e4 + (0-2i) * (.e225 * 
                                                                                                                                                                                                                                                                                                                   .e17/.e31 + .e21 * (4 + kappa))) * .e16) * .e11 + 
                                                                                                                                      .e254 + (((.e137 * .e49 * .e5 - .e148) * .e4 + (0-2i) * 
                                                                                                                                                  .e164 - (0+32i) * aTS * kappa * .e25 * .e5) * .e4 + 
                                                                                                                                                 (0-2i) * (2 * .e197 + 2 * (.e59 * .e17))) * .e28 + 
                                                                                                                                      (0-2i) * .e256 * .e72 * .e32 + .e204) * .e11 + (.e125 - 
                                                                                                                                                                                        ((-4+0i) * (.e266 + .e26 * ((-4+0i) * ((2 * .e84 + 
                                                                                                                                                                                                                                  36 * .e79) * .e6 - .e25 * (12 * .e63 + 4 * .e61)) + 
                                                                                                                                                                                                                      .e224 * .e6 + (.e246 * .e28 + 22 * .e37 + 5 * 
                                                                                                                                                                                                                                       .e70) * .e11 + .e258 + (((.e51 * .e105 + (24+0i) * 
                                                                                                                                                                                                                                                                   aTS * kappa * .e25 * .e5) * .e4 + .e176 + .e278) * 
                                                                                                                                                                                                                                                                 .e31 + (0-2i) * .e246 * .e17) * .e46 + .e260 * 
                                                                                                                                                                                                                      .e277) * .e5) + ((-4+0i) * .e205/.e4 + (.e192 + 
                                                                                                                                                                                                                                                                (0-2i) * .e188) * .e6 + (0-2i) * (.e239 * .e12/.e4 + 
                                                                                                                                                                                                                                                                                                    2 * (.e188 * .e6)))/.e4)) * .e13 + ((0-2i) * 
                                                                                                                                                                                                                                                                                                                                          ((0-2i) * (.e177 + .e274)/.e4 + 2 * .e76 - (.e229 + 
                                                                                                                                                                                                                                                                                                                                                                                        (-4+0i) * (.e275 + .e26 * ((.e190 + .e213) * 
                                                                                                                                                                                                                                                                                                                                                                                                                     .e28 + .e99 * .e277 + .e272) * .e5))) * .e16 + 
                                                                                                                                                                                                                                                                                                                                          (0+16i) * .e237) * .e6 + (0-2i) * ((.e230 * .e138 * 
                                                                                                                                                                                                                                                                                                                                                                                .e60 + .e269) * .e32 + .e269 * .e17 - .e193 * .e28 * 
                                                                                                                                                                                                                                                                                                                                                                               .e5) * .e17) * .e11 + (((-4+0i) * (.e188 + .e128/.e4)/.e4 + 
                                                                                                                                                                                                                                                                                                                                                                                                         (0-2i) * ((.e192 + ((0-2i) * (.e161 - (.e229 + (-4+0i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                  (.e275 + .e26 * (.e157 + (.e8 + (0-2i) * (.e107 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              .e212 - .e214)) * .e25 + .e141) * .e5))) - 
                                                                                                                                                                                                                                                                                                                                                                                                                               (-8+0i) * .e69/.e4) * .e6 - .e261)/.e4 + .e125 - 
                                                                                                                                                                                                                                                                                                                                                                                                                     (-4+0i) * (.e266 + .e26 * (.e231 + (.e224 + 6 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                           ((-4+0i) * .e79)) * .e6 + .e252 + ((.e222 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 4 * .e41) * .e28 + 14 * .e37 + 4 * .e70) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                  .e11 + ((0-2i) * (.e159 + 2 * .e165) + (32+0i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                            aTS * kappa * .e25 * .e5 + 5 * .e178) * .e13 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                  (0-2i) * (.e111 * .e46 * .e17 + .e49 * .e209 - 
                                                                                                                                                                                                                                                                                                                                                                                                                                                              .e99 * (.e210 + 4 * .e63))) * .e5))) * .e6/.e4 + 
                                                                                                                                                                                                                                                                                                                                                                                                        .e253 - (-4+0i) * ((-4+0i) * (.e21 * (6/.e4^4 + .e26 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                .e28 * .e5 * .e12) - .e10 * .e25 * .e109 * .e5) * 
                                                                                                                                                                                                                                                                                                                                                                                                                             .e6 + .e26 * ((-4+0i) * ((.e170 * .e132 + .e271 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                         .e273 - .e99 * (5 * .e102 - 4/.e87)) * .e6 - (.e49 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (3 * .e61 + 8 * .e63) + .e26 * (.e251 * .e13 + .e259) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         .e5)) + ((-12+0i) * (.e152 + 2 * .e167) + (0-2i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .e200 * .e16 + (0+24i) * .e175) * .e6 + ((-4+0i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ((3 * .e84 + 32 * .e79) * .e6 - .e279) + (.e225 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           .e28 + .e272 + .e211) * .e11 + (((.e21 * (.e8 + (0-2i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (.e106 + mu - .e140)) + (40+0i) * aTS * kappa * .e25 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               .e5) * .e4 + (0-12i) * .e21 + (0-2i) * (.e115 * .e17/.e31 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         .e21 * .e6) + .e278) * .e31 + (0-2i) * (.e222 + .e80) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             .e17) * .e46 + 3 * (.e49 * .e11 - .e40 * .e13 * .e5)) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                             .e11 + ((0-2i) * (((.e135 + (3 * (.e59 * .e4) - 3 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ((0-2i) * .e112/.e4)) * .e17/.e4)/.e4 + .e274)/.e4 - 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (.e40 * .e105 * .e5 + .e51 * (.e61 + 2 * .e63))) + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       (64+0i) * aTS * kappa * .e49 * .e5 + 3 * .e76 - ((-4+0i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (4 * .e81 + .e26 * (((-40+0i) * .e6 * .e12 + 6 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 .e41) * .e28 + .e99 * (4 * .e38 + 5 * mu - 10 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          .e39) + 20 * .e37) * .e5) + 3 * (.e239/.e4))) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                             .e13 + .e268) * .e5)) * .e13 + (0-32i) * ((0-2i) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         .e4^(kappa - 8) * .e12 * .e17 * .e32 * .e60 * .e110 + 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2 * ((((.e11 * .e138 * .e60 - .e10 * .e181 * .e5) * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  .e32 - .e10 * .e86 * .e181 * .e5) * .e17 - .e270 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 .e86 * .e181 * .e5) * .e12 - .e10 * (.e180 * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .e86 * .e181 + 2 * (.e179 * .e184 * .e4^(.e27 - 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   4))) * .e5)) * .e6) * .e5) * exp(.e8 * u) * exp(aTS * 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (bTS - .e4^kappa))
}
mu1=1/1i^1*phi1(0) #mean
mu2=1/1i^2*phi2(0) #sd
mu3=1/1i^3*phi3(0)
mu4=1/1i^4*phi4(0)
mu3/mu2^(3/2) #skewness
mu4/mu2^2 #kurtosis
ps=c(1,10,25,75,90,99)/100

resTS=matrix(numeric(length(ps)*11),ncol=11)
for(i in 1:length(ps)){
  p=ps[i]
  Finv_p=HInv(p,abN(10^-9,lower_bound=0)[1],abN(10^-9,lower_bound=0)[2],10^7,10^-9) #F^-1(p)
  myabN=abN(eps_global,lower_bound=0)
  a=myabN[1]
  b=myabN[2]
  N=myabN[3]
  y=HInv(p,a,b,N,eps_global) #H^-1(p)
  H_y=H(y,a,b,N) #H(y)
  F_y=H(y,abN(10^-9,lower_bound=0)[1],abN(10^-9,lower_bound=0)[2],10^7) #F(y)
  
  resTS[i,1]=eps_global
  resTS[i,2]=b-a
  resTS[i,3]=N
  resTS[i,4]=p
  resTS[i,5]=y
  resTS[i,6]=abs(H_y-F_y)
  resTS[i,7]=abs(y-Finv_p)
  resTS[i,8]=min(h(y-eps_global,a,b,N),h(y+eps_global,a,b,N))
  resTS[i,9]=2*eps_global/resTS[i,8]+eps_global
  resTS[i,10]=H(y,abN(10^-9,lower_bound=0)[1],abN(10^-9,lower_bound=0)[2],10^7)
  resTS[i,11]=HGP(y,T)
}
resTS=as.data.frame(resTS)
names(resTS)=c("eps","b-a","N","p", "y","abs(H_y-F_y)",
               "abs(y-Finv_p)","h(y)","RHS","F_y_COS_ref","F_y_GP_ref")
resTS$DIS="TS"

res=rbind(resTS,resNormal,resNIG)
myname=paste(c("res",eps_global,".csv"),collapse="")
write.table(res,myname,sep=";",col.names=T,row.names=F)
